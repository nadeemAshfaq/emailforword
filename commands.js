!function(){var e,t,o;function i(e){var t;Office.context.ui.displayDialogAsync("https://nadeemashfaq.github.io/emailforword/assets/setemail.html",{height:80,width:40},(function(o){(t=o.value).addEventHandler(Office.EventType.DialogMessageReceived,(function(o){t.close();var i=o.message;window.localStorage.setItem("email",i),e.completed()}))}))}Office.onReady((function(e){e.host,Office.HostType.Outlook})),Office.actions.associate("sendEmail",(function(a){window.localStorage.getItem("token");var n=window.localStorage.getItem("email");n?Office.context.ui.displayDialogAsync("https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=447b0be2-9297-4238-b3dc-4b2df1569872&response_type=token&redirect_uri=https://nadeemashfaq.github.io/emailforword/assets/redirectPage.html&scope=user.read+mail.send+openid+profile+email&response_mode=fragment&state=12345&nonce=678910",{height:80,width:40},(function(i){(o=i.value).addEventHandler(Office.EventType.DialogMessageReceived,(function(i){o.close(),e=i.message,window.localStorage.setItem("token",i.message),t=(t=Office.context.mailbox.item.itemId).replaceAll("/","-"),window.localStorage.setItem("mesid",t),fetch("https://graph.microsoft.com/v1.0/me/messages/"+t+"/forward",{method:"POST",headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"},body:JSON.stringify({toRecipients:[{emailAddress:{address:n}}]})}).then((function(e){if(!e.ok)throw new Error("Failed to forward email")})).catch((function(e){console.error("Error forwarding email:",e)})),a.completed()}))})):i(a)})),Office.actions.associate("setEmail",(function(e){i(e)}))}();
//# sourceMappingURL=commands.js.map
