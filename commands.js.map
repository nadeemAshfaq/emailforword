{"version":3,"file":"commands.js","mappings":"YAQA,IAAIA,EAEAC,EA8BAC,EAfJ,SAASC,EAAIC,GACX,IAAIC,EAEJC,OAAOC,QAAQC,GAAGC,mBADV,8CACgC,CAAEC,OAAQ,GAAIC,MAAO,KAAM,SAAUC,IAC3EP,EAAgBO,EAAYC,OACdC,gBAAgBR,OAAOS,UAAUC,uBAAuB,SAAUC,GAC9EZ,EAAca,QACd,IAAIC,EAAQF,EAAIG,QAChBC,OAAOC,aAAaC,QAAQ,QAASJ,GAErCf,EAAMoB,WACR,GACF,GACF,CApCAlB,OAAOmB,SAAQ,SAACC,GAEVA,EAAKC,KAASrB,OAAOsB,SAASC,OAEpC,IAkIAvB,OAAOwB,QAAQC,UAAU,aA/FzB,SAAmB3B,GACAiB,OAAOC,aAAaU,QAAQ,SAA7C,IAyCIC,EAAyBZ,OAAOC,aAAaU,QAAQ,SACrDC,EAGF3B,OAAOC,QAAQC,GAAGC,mBADhB,gSACsC,CAAEC,OAAQ,GAAIC,MAAO,KAAM,SAAUC,IAC3EV,EAAcU,EAAYC,OACdC,gBAAgBR,OAAOS,UAAUC,uBAAuB,SAAUC,GAC5Ef,EAAYgB,QACZlB,EAAQiB,EAAIG,QACZC,OAAOC,aAAaC,QAAQ,QAASN,EAAIG,SAEzCnB,GADAA,EAAYK,OAAOC,QAAQ2B,QAAQC,KAAKC,QAClBC,WAAW,IAAK,KACtChB,OAAOC,aAAaC,QAAQ,QAAStB,GAGrCqC,MAAM,gDAAkDrC,EAAY,WAAY,CAC9EsC,OAAQ,OACRC,QAAS,CACPC,cAAe,UAAYzC,EAC3B,eAAgB,oBAElB0C,KAAMC,KAAKC,UAAU,CACnBC,aAAc,CACZ,CACEC,aAAc,CACZC,QAASd,SAOhBe,MAAK,SAACC,GACL,IAAIA,EAASC,GAGX,MAAM,IAAIC,MAAM,0BAEpB,IACCC,OAAM,SAACC,GACNC,QAAQD,MAAM,0BAA2BA,EAE3C,IAEFjD,EAAMoB,WACR,GACF,IAEArB,EAAIC,EAGR,IAOAE,OAAOwB,QAAQC,UAAU,YAJzB,SAAkB3B,GAChBD,EAAIC,EACN,G","sources":["webpack://office-addin-taskpane-react-js/./src/commands/commands.js"],"sourcesContent":["// const { debug } = require(\"webpack\");\n\nOffice.onReady((info) => {\n  // Office is ready\n  if (info.host === Office.HostType.Outlook) {\n  }\n});\n\nlet token; // Ensure that 'token' is defined globally\nlet fromEmail;\nvar messageId;\n\nfunction getItemRestId() {\n  if (Office.context.mailbox.diagnostics.hostName === \"OutlookIOS\") {\n    // itemId is already REST-formatted.\n    return Office.context.mailbox.item.itemId;\n  } else {\n    // Convert to an item ID for API v2.0.\n    return Office.context.mailbox.convertToRestId(\n      Office.context.mailbox.item.itemId,\n      Office.MailboxEnums.RestVersion.v2_0\n    );\n  }\n}\n\nfunction run(event) {\n  let emaildialogue;\n  var a = \"https://localhost:3000/assets/setemail.html\";\n  Office.context.ui.displayDialogAsync(a, { height: 80, width: 40 }, function (asyncResult) {\n    emaildialogue = asyncResult.value;\n    emaildialogue.addEventHandler(Office.EventType.DialogMessageReceived, function (arg) {\n      emaildialogue.close();\n      let email = arg.message;\n      window.localStorage.setItem(\"email\", email);\n\n      event.completed();\n    });\n  });\n}\n\nlet Logindialog;\nfunction sendEmail(event) {\n  let checkToken = window.localStorage.getItem(\"token\");\n  //if (checkToken) {\n\n  // messageId = Office.context.mailbox.item.itemId;\n  // messageId = messageId.replaceAll(\"/\", \"-\");\n  // window.localStorage.setItem(\"mesid\",messageId);\n  // let Recipiant_emailAddress = window.localStorage.getItem(\"email\")\n\n  // fetch(\"https://graph.microsoft.com/v1.0/me/messages/\"+messageId+\"/forward\", {\n  //   method: 'POST',\n  //   headers: {\n  //       'Authorization': \"Bearer \"+checkToken, // Include the access token obtained after authentication\n  //       'Content-Type': 'application/json'\n  //   },\n  //   body: JSON.stringify({\n  //       toRecipients: [\n  //           {\n  //               emailAddress: {\n  //                   address: Recipiant_emailAddress\n  //               }\n  //           }\n  //       ],\n  //       // Include any additional options here\n  //   })\n  // })\n  // .then(response => {\n  //   if (response.ok) {\n  //     // Show success message or perform other actions\n\n  //     } else {\n  //       throw new Error('Failed to forward email');\n  //   }\n  // })\n  // .catch(error => {\n  //   console.error('Error forwarding email:', error);\n  //   // Handle any errors that occur during the request\n  // });\n  // event.completed();\n\n  //} else {\n\n  let Recipiant_emailAddress = window.localStorage.getItem(\"email\");\n  if (Recipiant_emailAddress) {\n    var a =\n      \"https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=447b0be2-9297-4238-b3dc-4b2df1569872&response_type=token&redirect_uri=https://localhost:3000/assets/redirectPage.html&scope=user.read+mail.send+openid+profile+email&response_mode=fragment&state=12345&nonce=678910\";\n    Office.context.ui.displayDialogAsync(a, { height: 80, width: 40 }, function (asyncResult) {\n      Logindialog = asyncResult.value;\n      Logindialog.addEventHandler(Office.EventType.DialogMessageReceived, function (arg) {\n        Logindialog.close();\n        token = arg.message;\n        window.localStorage.setItem(\"token\", arg.message);\n        messageId = Office.context.mailbox.item.itemId;\n        messageId = messageId.replaceAll(\"/\", \"-\");\n        window.localStorage.setItem(\"mesid\", messageId);\n        // let Recipiant_emailAddress = window.localStorage.getItem(\"email\")\n\n        fetch(\"https://graph.microsoft.com/v1.0/me/messages/\" + messageId + \"/forward\", {\n          method: \"POST\",\n          headers: {\n            Authorization: \"Bearer \" + token, // Include the access token obtained after authentication\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify({\n            toRecipients: [\n              {\n                emailAddress: {\n                  address: Recipiant_emailAddress,\n                },\n              },\n            ],\n            // Include any additional options here\n          }),\n        })\n          .then((response) => {\n            if (response.ok) {\n              // Show success message or perform other actions\n            } else {\n              throw new Error(\"Failed to forward email\");\n            }\n          })\n          .catch((error) => {\n            console.error(\"Error forwarding email:\", error);\n            // Handle any errors that occur during the request\n          });\n\n        event.completed();\n      });\n    });\n  } else {\n    run(event);\n  }\n  // }\n}\n\nOffice.actions.associate(\"sendEmail\", sendEmail);\nfunction setEmail(event) {\n  run(event);\n}\n\nOffice.actions.associate(\"setEmail\", setEmail);\n"],"names":["token","messageId","Logindialog","run","event","emaildialogue","Office","context","ui","displayDialogAsync","height","width","asyncResult","value","addEventHandler","EventType","DialogMessageReceived","arg","close","email","message","window","localStorage","setItem","completed","onReady","info","host","HostType","Outlook","actions","associate","getItem","Recipiant_emailAddress","mailbox","item","itemId","replaceAll","fetch","method","headers","Authorization","body","JSON","stringify","toRecipients","emailAddress","address","then","response","ok","Error","catch","error","console"],"sourceRoot":""}